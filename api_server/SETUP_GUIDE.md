# üöÄ KNN BREAST CANCER PREDICTION API

**Flask REST API server ƒë·ªÉ deploy model KNN breast cancer prediction l√™n online cho c√°c d·ª± √°n React, Express, ho·∫∑c b·∫•t k·ª≥ web framework n√†o kh√°c.**

## üìÅ C·∫•u tr√∫c th∆∞ m·ª•c
```
api_server/
‚îú‚îÄ‚îÄ app.py                    # Main Flask application
‚îú‚îÄ‚îÄ requirements.txt          # Python dependencies
‚îú‚îÄ‚îÄ start_server.bat         # Windows batch file ƒë·ªÉ kh·ªüi ƒë·ªông server
‚îú‚îÄ‚îÄ test_server.bat          # Windows batch file ƒë·ªÉ test API
‚îú‚îÄ‚îÄ test_api.py              # API test client
‚îú‚îÄ‚îÄ react_example.py         # React component example
‚îî‚îÄ‚îÄ README.md               # H∆∞·ªõng d·∫´n n√†y
```

## üîß C√†i ƒë·∫∑t v√† kh·ªüi ƒë·ªông

### C√°ch 1: S·ª≠ d·ª•ng batch file (Windows)
```bash
# Kh·ªüi ƒë·ªông server
double-click start_server.bat
```

### C√°ch 2: Manual setup
```bash
# 1. C√†i ƒë·∫∑t dependencies
cd api_server
pip install -r requirements.txt

# 2. Kh·ªüi ƒë·ªông server
python app.py
```

Server s·∫Ω ch·∫°y t·∫°i: **http://localhost:5000**

## üß™ Testing API

### C√°ch 1: S·ª≠ d·ª•ng batch file
```bash
double-click test_server.bat
```

### C√°ch 2: Manual testing
```bash
python test_api.py
```

### C√°ch 3: curl commands
```bash
# Health check
curl http://localhost:5000/

# Model info
curl http://localhost:5000/model/info

# Single prediction
curl -X POST http://localhost:5000/predict ^
  -H "Content-Type: application/json" ^
  -d "{\"features\": [2, 1, 1, 1, 2, 1, 2, 1, 1]}"
```

## üì° API Endpoints

### üîç Health Check
```
GET /
```

### üìä Model Information
```
GET /model/info
```

### üéØ Single Prediction
```
POST /predict
Content-Type: application/json

{
  "features": [2, 1, 1, 1, 2, 1, 2, 1, 1]
}
```

### üìä Batch Prediction
```
POST /predict/batch
Content-Type: application/json

{
  "samples": [
    [2, 1, 1, 1, 2, 1, 2, 1, 1],
    [8, 7, 8, 7, 6, 9, 7, 8, 3]
  ]
}
```

## üåê Integration v·ªõi Web Apps

### React Integration
```javascript
// G·ªçi API t·ª´ React component
const predictCancer = async (features) => {
  const response = await fetch('http://localhost:5000/predict', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      features: features
    })
  });
  
  return await response.json();
};

// Usage
const features = [2, 1, 1, 1, 2, 1, 2, 1, 1];
const result = await predictCancer(features);
console.log(result.prediction.diagnosis); // "Benign" or "Malignant"
```

### Express.js Proxy
```javascript
const express = require('express');
const axios = require('axios');
const app = express();

app.post('/api/cancer-prediction', async (req, res) => {
  try {
    const response = await axios.post('http://localhost:5000/predict', req.body);
    res.json(response.data);
  } catch (error) {
    res.status(500).json({ error: 'Prediction failed' });
  }
});
```

### Vue.js Integration
```javascript
// Vue component method
async makePrediction(features) {
  try {
    const response = await this.$http.post('http://localhost:5000/predict', {
      features: features
    });
    this.result = response.data;
  } catch (error) {
    console.error('Prediction error:', error);
  }
}
```

## üìä Input Format

**T·∫•t c·∫£ 9 features ph·∫£i l√† s·ªë t·ª´ 1-10:**

1. **clump_thickness**: ƒê·ªô d√†y kh·ªëi t·∫ø b√†o (1-10)
2. **uniform_cell_size**: K√≠ch th∆∞·ªõc ƒë·ªìng ƒë·ªÅu t·∫ø b√†o (1-10)  
3. **uniform_cell_shape**: H√¨nh d·∫°ng ƒë·ªìng ƒë·ªÅu t·∫ø b√†o (1-10)
4. **marginal_adhesion**: ƒê·ªô b√°m d√≠nh r√¨a (1-10)
5. **single_epithelial_cell_size**: K√≠ch th∆∞·ªõc t·∫ø b√†o bi·ªÉu m√¥ ƒë∆°n (1-10)
6. **bare_nuclei**: Nh√¢n tr·∫ßn (1-10)
7. **bland_chromatin**: Ch·∫•t nhi·ªÖm s·∫Øc nh·∫°t (1-10)
8. **normal_nucleoli**: Nh√¢n con b√¨nh th∆∞·ªùng (1-10)
9. **mitoses**: Ph√¢n b√†o (1-10)

## üìù Response Format

```json
{
  "status": "success",
  "prediction": {
    "diagnosis": "Benign",
    "confidence": 0.667,
    "risk_level": "Low",
    "raw_prediction": 2,
    "probabilities": {
      "benign": 0.667,
      "malignant": 0.333
    }
  },
  "medical_interpretation": {
    "interpretation": "The tissue sample shows characteristics consistent with benign (non-cancerous) cells.",
    "recommendation": "Continue regular screening as recommended by healthcare provider.",
    "disclaimer": "This prediction is for research purposes only..."
  },
  "input_features": {
    "clump_thickness": 2,
    "uniform_cell_size": 1,
    ...
  },
  "timestamp": "2025-07-20T10:04:19.123456"
}
```

## üåç HOST ONLINE - Deploy l√™n Internet

### üÜì **MI·ªÑN PH√ç - Render.com (Recommended)**

**B∆∞·ªõc 1:** Upload code l√™n GitHub
```bash
git init
git add .
git commit -m "KNN Cancer Prediction API"
git remote add origin https://github.com/yourusername/knn-cancer-api.git
git push -u origin main
```

**B∆∞·ªõc 2:** Deploy tr√™n Render
1. ƒêƒÉng k√Ω t·∫°i https://render.com
2. Connect GitHub repository  
3. Ch·ªçn "Web Service"
4. Settings:
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `gunicorn -w 4 -b 0.0.0.0:$PORT app:app`
   - **Environment**: Python 3
   - **Plan**: Free

**B∆∞·ªõc 3:** T·∫°o file `render.yaml` (optional)
```yaml
services:
  - type: web
    name: knn-cancer-api
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn -w 4 -b 0.0.0.0:$PORT app:app
    envVars:
      - key: FLASK_ENV
        value: production
```

**Result:** API s·∫Ω c√≥ URL nh∆∞ `https://your-app-name.onrender.com`

---

### üÜì **Heroku (Mi·ªÖn ph√≠ v·ªõi gi·ªõi h·∫°n)**

**B∆∞·ªõc 1:** T·∫°o `Procfile`
```
web: gunicorn -w 4 -b 0.0.0.0:$PORT app:app
```

**B∆∞·ªõc 2:** Deploy
```bash
# Install Heroku CLI
heroku login
heroku create your-app-name
git push heroku main
```

**B∆∞·ªõc 3:** Scale app
```bash
heroku ps:scale web=1
```

**Result:** API t·∫°i `https://your-app-name.herokuapp.com`

---

### üÜì **Railway.app**

**B∆∞·ªõc 1:** Connect GitHub t·∫°i https://railway.app
**B∆∞·ªõc 2:** Deploy v·ªõi 1 click
**B∆∞·ªõc 3:** Environment variables:
```
PORT=5000
FLASK_ENV=production
```

**Result:** Auto-generated URL nh∆∞ `https://your-app.up.railway.app`

---

### üÜì **Vercel (Serverless)**

**B∆∞·ªõc 1:** T·∫°o `vercel.json`
```json
{
  "version": 2,
  "builds": [
    {
      "src": "app.py",
      "use": "@vercel/python"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "app.py"
    }
  ]
}
```

**B∆∞·ªõc 2:** Deploy
```bash
npm i -g vercel
vercel --prod
```

---

### üí∞ **DigitalOcean App Platform**

**B∆∞·ªõc 1:** Connect GitHub
**B∆∞·ªõc 2:** App Spec:
```yaml
name: knn-cancer-api
services:
- name: api
  source_dir: /
  github:
    repo: yourusername/knn-cancer-api
    branch: main
  run_command: gunicorn -w 4 -b 0.0.0.0:$PORT app:app
  environment_slug: python
  instance_count: 1
  instance_size_slug: basic-xxs
```

**Cost:** ~$5/month

---

### üí∞ **AWS EC2 (Full Control)**

**B∆∞·ªõc 1:** Launch EC2 instance (Ubuntu)
**B∆∞·ªõc 2:** SSH v√† setup
```bash
# Connect to EC2
ssh -i your-key.pem ubuntu@your-instance-ip

# Install Python & dependencies
sudo apt update
sudo apt install python3 python3-pip nginx
pip3 install -r requirements.txt

# Run with systemd
sudo nano /etc/systemd/system/knn-api.service
```

**Systemd service file:**
```ini
[Unit]
Description=KNN Cancer API
After=network.target

[Service]
User=ubuntu
WorkingDirectory=/home/ubuntu/knn-cancer-api
ExecStart=/usr/bin/python3 -m gunicorn -w 4 -b 127.0.0.1:5000 app:app
Restart=always

[Install]
WantedBy=multi-user.target
```

**Nginx config:**
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## üîí Production Deployment (Local/VPS)

### Gunicorn (Linux/Production)
```bash
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

### Docker Deployment
```dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 5000
CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "app:app"]
```

### Environment Variables
```bash
# Development
export FLASK_ENV=development
export FLASK_DEBUG=1

# Production  
export FLASK_ENV=production
export FLASK_DEBUG=0
```

## ‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng

- **Ch·ªâ d√†nh cho nghi√™n c·ª©u**: API n√†y kh√¥ng thay th·∫ø ch·∫©n ƒëo√°n y t·∫ø chuy√™n nghi·ªáp
- **CORS enabled**: API h·ªó tr·ª£ cross-origin requests cho web apps
- **Error handling**: API tr·∫£ v·ªÅ error messages chi ti·∫øt
- **Model validation**: Ki·ªÉm tra t·ª± ƒë·ªông model c√≥ t·∫£i ƒë∆∞·ª£c kh√¥ng
- **Input validation**: Validate t·∫•t c·∫£ input features (1-10 range)

## üéØ Sample Test Cases

```javascript
// Benign case (expected: Benign)
const benignCase = [2, 1, 1, 1, 2, 1, 2, 1, 1];

// Malignant case (expected: Malignant)  
const malignantCase = [8, 7, 8, 7, 6, 9, 7, 8, 3];

// Borderline case
const borderlineCase = [5, 3, 4, 3, 3, 5, 4, 4, 1];
```

## üîó Links v√† Resources

- **Model accuracy**: ~97.08% tr√™n test set
- **Algorithm**: K-Nearest Neighbors (k=3)
- **Dataset**: Wisconsin Breast Cancer Dataset
- **Flask docs**: https://flask.palletsprojects.com/
- **React integration**: Xem file `react_example.py`

## üìû Troubleshooting

### API Server kh√¥ng start ƒë∆∞·ª£c
1. Check Python version (‚â•3.7)
2. Install dependencies: `pip install -r requirements.txt`
3. Check port 5000 kh√¥ng b·ªã chi·∫øm

### Model kh√¥ng load ƒë∆∞·ª£c  
1. ƒê·∫£m b·∫£o file KNN model t·ªìn t·∫°i trong `../Models/`
2. Check file permissions
3. Verify model file kh√¥ng corrupted

### CORS issues t·ª´ browser
API ƒë√£ enable CORS m·∫∑c ƒë·ªãnh. N·∫øu v·∫´n c√≥ v·∫•n ƒë·ªÅ:
```javascript
// Th√™m mode: 'cors' v√†o fetch request
fetch('http://localhost:5000/predict', {
  method: 'POST',
  mode: 'cors',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({features: [...]}),
});
```

## üéâ Ready to Use!

API server ƒë√£ s·∫µn s√†ng ƒë·ªÉ integrate v·ªõi:
- ‚úÖ React applications
- ‚úÖ Vue.js applications  
- ‚úÖ Express.js backends
- ‚úÖ Next.js full-stack apps
- ‚úÖ Mobile apps (React Native, Flutter)
- ‚úÖ Desktop apps (Electron)
- ‚úÖ B·∫•t k·ª≥ platform n√†o support HTTP requests
